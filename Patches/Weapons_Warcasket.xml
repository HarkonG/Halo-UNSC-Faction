<?xml version="1.0" encoding="utf-8" ?>

<Patch>
    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Vanilla Factions Expanded - Pirates</li>
        </mods>
        <match Class="PatchOperationSequence">
            <operations>

                <li Class="PatchOperationAdd">
                    <xpath>/Defs</xpath>
                    <value>

                        <ThingDef ParentName="VFEP_BaseWarcasketGun">
                            <defName>VFEP_WarcasketGun_Minigun</defName>
                            <label>warcasket minigun</label>
                            <description>An upscaled version of the minigun designed for use by a warcasket. It uses larger caliber rounds which are poorly made en masse due to how many rounds need to be manufactured. Thus, it has a slower rate of fire and armor penetration, but who cares because no one wants to be on the receiving end of this amount of dakka.</description>
                            <graphicData>
                                <texPath>Things/Item/Weapons/WarcasketMinigun</texPath>
                            </graphicData>
                            <soundInteract>Interact_Rifle</soundInteract>
                            <statBases>
                                <MarketValue>2240</MarketValue>
                                <WorkToMake>55000</WorkToMake>
                                <Mass>45</Mass>
                                <AccuracyTouch>0.15</AccuracyTouch>
                                <AccuracyShort>0.25</AccuracyShort>
                                <AccuracyMedium>0.25</AccuracyMedium>
                                <AccuracyLong>0.18</AccuracyLong>
                                <RangedWeapon_Cooldown>2.6</RangedWeapon_Cooldown>
                            </statBases>
                            <weaponTags>
                                <li>WarcasketHeavy</li>
                            </weaponTags>
                            <verbs>
                                <li>
                                    <verbClass>Verb_Shoot</verbClass>
                                    <hasStandardCommand>true</hasStandardCommand>
                                    <defaultProjectile>VFEP_Bullet_WarcasketMinigun</defaultProjectile>
                                    <warmupTime>3.1</warmupTime>
                                    <range>30.9</range>
                                    <ticksBetweenBurstShots>8</ticksBetweenBurstShots>
                                    <burstShotCount>25</burstShotCount>
                                    <soundCast>VFEP_Shot_Minigun</soundCast>
                                    <soundCastTail>GunTail_Medium</soundCastTail>
                                    <muzzleFlashScale>9</muzzleFlashScale>
                                </li>
                            </verbs>
                            <tools>
                                <li>
                                    <label>stock</label>
                                    <capacities>
                                        <li>Blunt</li>
                                    </capacities>
                                    <power>12</power>
                                    <cooldownTime>4</cooldownTime>
                                </li>
                                <li>
                                    <label>barrel</label>
                                    <capacities>
                                        <li>Blunt</li>
                                        <li>Poke</li>
                                    </capacities>
                                    <power>12</power>
                                    <cooldownTime>4</cooldownTime>
                                </li>
                            </tools>
                            <modExtensions>
                                <li Class="VFECore.FloorGraphicExtension">
                                    <graphicData>
                                        <graphicClass>Graphic_Single</graphicClass>
                                        <texPath>Things/Item/WeaponsBoxed/WarcasketMinigun_OnFloor</texPath>
                                        <onGroundRandomRotateAngle>0</onGroundRandomRotateAngle>
                                        <drawSize>1</drawSize>
                                    </graphicData>
                                </li>
                            </modExtensions>
                        </ThingDef>
                    </value>
                </li>

                <li Class="PatchOperationAdd">
                    <xpath>/Defs</xpath>
                    <value>
                        <ThingDef ParentName="BaseBullet">
                            <defName>VFEP_Bullet_WarcasketMinigun</defName>
                            <label>warcasket minigun bullet</label>
                            <graphicData>
                                <texPath>Things/Projectile/Bullet_Big</texPath>
                                <graphicClass>Graphic_Single</graphicClass>
                            </graphicData>
                            <projectile>
                                <damageDef>Bullet</damageDef>
                                <damageAmountBase>12</damageAmountBase>
                                <stoppingPower>0.5</stoppingPower>
                                <armorPenetrationBase>0.12</armorPenetrationBase>
                                <speed>46</speed>
                            </projectile>
                        </ThingDef>
                    </value>
                </li>

                <li Class="PatchOperationAdd">
                    <xpath>/Defs</xpath>
                    <value>
                        <ThingDef ParentName="VFEP_WarcasketWeaponBoxBase">
                            <defName>VFEP_Box_Minigun</defName>
                            <label>warcasket minigun</label>
                            <description>An upscaled version of the minigun designed for use by a warcasket. It uses larger caliber rounds which are poorly made en masse due to how many rounds need to be manufactured. Thus, it has a slower rate of fire and armor penetration, but who cares because no one wants to be on the receiving end of this amount of dakka.</description>
                            <graphicData>
                                <texPath>Things/Item/WeaponsBoxed/WarcasketMinigun_OnFloor</texPath>
                            </graphicData>
                            <costList>
                                <Steel>240</Steel>
                                <Plasteel>10</Plasteel>
                                <ComponentIndustrial>8</ComponentIndustrial>
                            </costList>
                            <statBases>
                                <MarketValue>2240</MarketValue>
                                <Mass>45</Mass>
                                <WorkToBuild>55000</WorkToBuild>
                            </statBases>
                            <comps>
                                <li Class="VFEPirates.CompProperties_WeaponBox">
                                    <weaponToEquip>VFEP_WarcasketGun_Minigun</weaponToEquip>
                                </li>
                            </comps>
                        </ThingDef>
                    </value>
                </li>

                <li Class="PatchOperationReplace" MayRequire="CETeam.CombatExtended">
                    <xpath>/Defs/ThingDef[defName = "HALO_UAG40_Warcasket"]/tools
                    </xpath>
                    <value>
                        <tools>
                            <li Class="CombatExtended.ToolCE">
                                <label>barrel</label>
                                <capacities>
                                    <li>Blunt</li>
                                </capacities>
                                <power>35</power>
                                <cooldownTime>2.44</cooldownTime>
                                <armorPenetrationBlunt>16</armorPenetrationBlunt>
                                <linkedBodyPartsGroup>Barrel</linkedBodyPartsGroup>
                            </li>
                        </tools>
                    </value>
                </li>

                <li Class="CombatExtended.PatchOperationMakeGunCECompatible" MayRequire="CETeam.CombatExtended">
                    <defName>HALO_UAG40_Warcasket</defName>
                    <statBases>
                        <Bulk>25</Bulk>
                        <SwayFactor>1.72</SwayFactor>
                        <ShotSpread>0.20</ShotSpread>
                        <SightsEfficiency>1.0</SightsEfficiency>
                        <RangedWeapon_Cooldown>0.36</RangedWeapon_Cooldown>
                    </statBases>
                    <Properties>
                        <recoilAmount>2.80</recoilAmount>
                        <verbClass>CombatExtended.Verb_ShootCE</verbClass>
                        <hasStandardCommand>true</hasStandardCommand>
                        <defaultProjectile>Bullet_40x53mmGrenade_HE</defaultProjectile>
                        <warmupTime>1.6</warmupTime>
                        <range>54</range>
                        <minRange>4</minRange>
                        <ticksBetweenBurstShots>9</ticksBetweenBurstShots>
                        <burstShotCount>4</burstShotCount>
                        <soundCast>HALO_Shot_UAG40_AGL</soundCast>
                        <soundCastTail>GunTail_Medium</soundCastTail>
                        <muzzleFlashScale>9</muzzleFlashScale>
                        <targetParams>
                            <canTargetLocations>true</canTargetLocations>
                        </targetParams>
                    </Properties>
                    <AmmoUser>
                        <magazineSize>20</magazineSize>
                        <reloadTime>7.0</reloadTime>
                        <ammoSet>AmmoSet_40x53mmGrenade</ammoSet>
                    </AmmoUser>
                    <FireModes>
                        <aiUseBurstMode>FALSE</aiUseBurstMode>
                        <aiAimMode>SuppressFire</aiAimMode>
                        <aimedBurstShotCount>2</aimedBurstShotCount>
                    </FireModes>
                </li>

            </operations>
        </match>
    </Operation>
</Patch>